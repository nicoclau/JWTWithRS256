using Microsoft.IdentityModel.Tokens;
using System;
using System.Security.Cryptography;

namespace Cryptography
{
    internal class Program
    {
        static void Main(string[] args)
        {

            var JWSWithRS256Input = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJ1RXJacF9SUjJsRVRiN205a2tmMTJOel8wWjJiaVAyVVZBSDNiRTRfNG5VIn0.eyJleHAiOjE2NTU5MTU2MzMsImlhdCI6MTY1NTkxNTMzMywianRpIjoiODMzYWYwZmItODc1NC00OTBlLTg1MDctMTRlMjY5ZTliNjViIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL3JlYWxtcy9NeVJlYWxtIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjFlZjNlMDJiLTU1MDMtNGJiMC1iNzQ4LTczODRmZDNhMTk3NSIsInR5cCI6IkJlYXJlciIsImF6cCI6Ik15QXBwIiwic2Vzc2lvbl9zdGF0ZSI6Ijc0NWI1Mjc5LTU2ZjctNDM3NC1hYmY1LTIyNzE1ZjM1ZTdlNyIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiaHR0cDovLzEwLjcuNy4xMTozMDAwIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJkZWZhdWx0LXJvbGVzLW15cmVhbG0iLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiTXlBcHAiOnsicm9sZXMiOlsiQWRtaW4iXX0sImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoiZW1haWwgcHJvZmlsZSIsInNpZCI6Ijc0NWI1Mjc5LTU2ZjctNDM3NC1hYmY1LTIyNzE1ZjM1ZTdlNyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwicHJlZmVycmVkX3VzZXJuYW1lIjoibmljb2xhcyJ9.CPsbaDaaQAkekeyPeEHy3d3ZH0b_CQoXmQUo-gZvTaW25XlUVvIGnM65YYLjC3Ox0OScsr4XDxveZOu6yG_CNqF5ik6JVaUFnlzi6tF1BL3wVv4CikQGJSQHcyqMuRsMN4ThGo4g1peagJsfNWQ8SFfgwoTKh7HETOARHgKMiBAD1lEoFR8oL_WG1tzwbe6W7tBk34F8YcTpknbtJaxilMuOaa5zpEw2SwWao7n1260kwnE_5cFQ0fcn813lS8Kg_naKuraqQXJjMaqLjTr3lMmtoMpDiQyUi6uG8IjMxp9NARMU23Axe8oWnk50dI__LgtNb5x5VYLScoLTZsoA7Q";

            var publicKeyBase64UrlEncoded = "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAi6G5wRCfqjXJFBhvK+UwAUFU9LDcT3aet0gGZk8hMMPfF5SEBaPqTDuLMh85VXtm0I0KBpUtlgNzMqcmWVoSFTNSSJnmBBmD/26xcidu/wuo4m3wTIca2kOLBtMP/3sjIDOXAQYaCOXjbbDbNB1S49VD6wUyJy8gGwiTsDzuZcNsS5c+hnAiI+WHqUnSll/EGZcKp1Yv7BZH9fYRXdTGYRGcH6ZRH8Nhl9w6QL+gSRA2wZLjS9r5NdZ5Ey8iSezs1Htdtg2sj0mA1QlvdOkPQVzD5hW80it5sHMY0l1W1XJSPnkdGNaTJXyn5Fto15uJhj5nE6MwkwiTfGlwxmZQLwIDAQAB";

            Console.WriteLine($"JWS valid ? {JwsWithRS256.IsJWSValidFromRS256(JWSWithRS256Input, publicKeyBase64UrlEncoded)}");

        }

       
    }
}